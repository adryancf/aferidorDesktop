
1 -> reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall /s | find "DisplayName" > programas_instalados.txt

2 -> Get-ItemProperty HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\* | Select-Object DisplayName, DisplayVersion, Publisher, InstallDate | Format-Table –AutoSize > C:\Users\Lori\Documents\InstalledPrograms-PS.txt


if ([IntPtr]::Size -eq 8)
{
	Write-Host "[*] OS: x64"
	Write-Host "[*] List the 64 bit programs that have been installed"
	$RegPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\"
	ListPrograms -RegPath $RegPath

	Write-Host "[+] List the 32 bit programs that have been installed"

	$RegPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\"
	ListPrograms -RegPath $RegPath
 }
else
{
	Write-Host "[*] OS: x86"
 	Write-Host "[*] List the 32 bit programs that have been installed"
	$RegPath = "Registry::HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\"
	ListPrograms -RegPath $RegPath
}

Isso ocorre porque, em sistemas de 64 bits, existem dois locais diferentes no Registro para registrar informações sobre programas: um para aplicativos de 32 bits e outro para aplicativos de 64 bits. Portanto, para obter uma lista completa de programas instalados, você pode precisar executar ambos os comandos:

reg query HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall /s  # Para programas de 64 bits
reg query HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall /s  # Para programas de 32 bits em sistemas de 64 bits

3 -> PSINFO


4-> wmic product get name (MSI)

---------------------------------------------------------------------------------------

Usar req query nestes registros:

reg query [registro] /s | findstr "DisplayName" 

- Todos os usuários do sistema
HKLM\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall 
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall


- Instalados apenas para o usuário atual
HKLCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall
HKLCU\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall


APARECE QUASE IGUAL O PAINEL

foreach ($UKey in 'HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*','HKLM:\SOFTWARE\Wow6432node\Microsoft\Windows\CurrentVersion\Uninstall\*','HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*','HKCU:\SOFTWARE\Wow6432node\Microsoft\Windows\CurrentVersion\Uninstall\*'){foreach ($Product in (Get-ItemProperty $UKey -ErrorAction SilentlyContinue)){if($Product.DisplayName -and $Product.SystemComponent -ne 1){$Product.DisplayName}}}

